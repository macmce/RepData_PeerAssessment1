---
title: "Reproducible Research: Peer Assessment 1"
author: "Mac McEacharn"
output: 
  html_document:
    keep_md: true
---

## Loading and preprocessing the data

```{r echo=TRUE, warning=FALSE}
library(ggplot2)
if (!file.exists("activity.csv") && file.exists("activity.zip")) {
    unzip("activity.zip", exdir = ".")
}
data <- na.omit(read.csv("activity.csv"))
data$date <- as.Date(data$date, format = "%Y-%m-%d")
```


## What is mean total number of steps taken per day?
``` {r}
stepsDay <- tapply(data$steps, data$date, sum)

qplot(x=stepsDay,  
      binwidth = 1000,
      xlab = 'Total Steps per Day', 
      ylab = 'Frequency (binwith=1000)')

```

```{r echo=TRUE, warning=FALSE}
meanStepsDay <- mean(stepsDay,na.rm=TRUE)
paste("Mean Steps per Day=",meanStepsDay)

```

```{r echo=TRUE, warning=FALSE}
medianStepsDay <- median(stepsDay,na.rm = TRUE)
paste("Median Steps per Day=",medianStepsDay)

```


## What is the average daily activity pattern?
```{r echo=TRUE, warning=FALSE}
stepsInterval <- aggregate(data$steps, 
                           by = list(interval = data$interval), 
                           FUN = mean, 
                           na.rm = TRUE)

colnames(stepsInterval) <- c("interval", "steps")
ggplot(stepsInterval, 
       aes(x= interval, y = steps)) +   
    geom_line(size = 1, color="gray") +   
    labs(x = "Interval", 
         y = "Steps", 
         title = "Average Daily Activity Pattern")

```

```{r echo=TRUE, warning=FALSE}
maxInterval <- stepsInterval[which.max(stepsInterval$steps),]
paste("The interval having the most steps is interval ",
      maxInterval[1],
      sep="")
```
## Imputing missing values



## Are there differences in activity patterns between weekdays and weekends?
